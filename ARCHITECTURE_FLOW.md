# ğŸ—ï¸ Rental Management System - Architecture Flow

## **ğŸ“Š System Architecture Diagram**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        HTTP REQUEST                            â”‚
â”‚                    (Browser â†’ Server)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    HANDLERS LAYER                              â”‚
â”‚              (HTTP Request/Response Handling)                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              rental_handler.go                          â”‚   â”‚
â”‚  â”‚  â€¢ Dashboard() - Main dashboard view                    â”‚   â”‚
â”‚  â”‚  â€¢ UnitDetails() - Unit detail view                     â”‚   â”‚
â”‚  â”‚  â€¢ GetUnits() - API endpoint                            â”‚   â”‚
â”‚  â”‚  â€¢ CreateTenant() - API endpoint                        â”‚   â”‚
â”‚  â”‚  â€¢ VacateTenant() - API endpoint                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SERVICE LAYER                               â”‚
â”‚                (Business Logic Orchestration)                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  unit_service   â”‚ â”‚ tenant_service  â”‚ â”‚ payment_service â”‚   â”‚
â”‚  â”‚  â€¢ GetUnits()   â”‚ â”‚ â€¢ GetTenants()  â”‚ â”‚ â€¢ GetPayments() â”‚   â”‚
â”‚  â”‚  â€¢ CreateUnit() â”‚ â”‚ â€¢ CreateTenant()â”‚ â”‚ â€¢ CreatePayment()â”‚   â”‚
â”‚  â”‚  â€¢ UpdateUnit() â”‚ â”‚ â€¢ MoveOutTenant()â”‚ â”‚ â€¢ MarkPaid()    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  REPOSITORY LAYER                              â”‚
â”‚                    (Data Access)                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                INTERFACES                               â”‚   â”‚
â”‚  â”‚  â€¢ UnitRepository interface                            â”‚   â”‚
â”‚  â”‚  â€¢ TenantRepository interface                          â”‚   â”‚
â”‚  â”‚  â€¢ PaymentRepository interface                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                POSTGRES IMPLEMENTATIONS                 â”‚   â”‚
â”‚  â”‚  â€¢ postgres_unit_repository.go                         â”‚   â”‚
â”‚  â”‚  â€¢ postgres_tenant_repository.go                       â”‚   â”‚
â”‚  â”‚  â€¢ postgres_payment_repository.go                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DATABASE LAYER                              â”‚
â”‚                    (PostgreSQL)                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ units table                                         â”‚   â”‚
â”‚  â”‚  â€¢ tenants table                                       â”‚   â”‚
â”‚  â”‚  â€¢ family_members table                                â”‚   â”‚
â”‚  â”‚  â€¢ payments table                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## **ğŸ”„ Request Flow Example:**

### **1. User Clicks Unit â†’ Unit Details**
```
Browser â†’ /unit/1 â†’ rental_handler.UnitDetails() â†’ 
unitService.GetUnitByID() â†’ unitRepo.GetUnitByID() â†’ 
Database â†’ Response â†’ Template â†’ HTML
```

### **2. User Adds Tenant â†’ Create Tenant**
```
Browser â†’ /api/tenants (POST) â†’ rental_handler.CreateTenant() â†’ 
tenantService.CreateTenant() â†’ tenantRepo.CreateTenant() â†’ 
Database â†’ Response â†’ Page Reload
```

### **3. User Vacates Tenant â†’ Move Out**
```
Browser â†’ /api/tenants/vacate (POST) â†’ rental_handler.VacateTenant() â†’ 
tenantService.MoveOutTenant() â†’ paymentRepo.DeletePaymentsByTenantID() â†’ 
tenantRepo.DeleteTenant() â†’ unitRepo.UpdateUnitOccupancy() â†’ 
Database â†’ Response â†’ Dashboard Redirect
```

## **ğŸ“ File Organization by Layer:**

### **ğŸŒ Presentation Layer (Handlers)**
```
internal/handlers/
â””â”€â”€ rental_handler.go          # All HTTP request handling
```

### **ğŸ§  Business Layer (Services)**
```
internal/service/
â”œâ”€â”€ unit_service.go            # Unit business logic
â”œâ”€â”€ tenant_service.go          # Tenant business logic
â””â”€â”€ payment_service.go         # Payment business logic
```

### **ğŸ’¾ Data Layer (Repositories)**
```
internal/repository/
â”œâ”€â”€ interfaces/                # Repository contracts
â”‚   â”œâ”€â”€ unit_repository.go
â”‚   â”œâ”€â”€ tenant_repository.go
â”‚   â””â”€â”€ payment_repository.go
â””â”€â”€ postgres/                  # PostgreSQL implementations
    â”œâ”€â”€ unit_repository.go
    â”œâ”€â”€ tenant_repository.go
    â””â”€â”€ payment_repository.go
```

### **ğŸ¢ Domain Layer (Models)**
```
internal/domain/
â”œâ”€â”€ unit.go                    # Unit business entity
â”œâ”€â”€ tenant.go                  # Tenant business entity
â”œâ”€â”€ family_member.go           # Family member entity
â””â”€â”€ payment.go                 # Payment entity
```

### **ğŸ¨ Web Layer (Templates)**
```
web/templates/
â”œâ”€â”€ dashboard.html             # Main dashboard
â””â”€â”€ unit-detail.html          # Unit detail page
```

## **ğŸ”— Dependency Flow:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Handlers  â”‚â”€â”€â”€â–¶â”‚   Services  â”‚â”€â”€â”€â–¶â”‚ Repositoriesâ”‚â”€â”€â”€â–¶â”‚  Database   â”‚
â”‚             â”‚    â”‚             â”‚    â”‚             â”‚    â”‚             â”‚
â”‚ â€¢ HTTP      â”‚    â”‚ â€¢ Business  â”‚    â”‚ â€¢ Data      â”‚    â”‚ â€¢ Storage   â”‚
â”‚ â€¢ Templates â”‚    â”‚ â€¢ Logic     â”‚    â”‚ â€¢ Access    â”‚    â”‚ â€¢ Queries   â”‚
â”‚ â€¢ Validationâ”‚    â”‚ â€¢ Rules     â”‚    â”‚ â€¢ SQL       â”‚    â”‚ â€¢ Tables    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                   â”‚                   â”‚
       â–¼                   â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Domain    â”‚    â”‚   Domain    â”‚    â”‚   Domain    â”‚
â”‚  Entities   â”‚    â”‚  Entities   â”‚    â”‚  Entities   â”‚
â”‚             â”‚    â”‚             â”‚    â”‚             â”‚
â”‚ â€¢ Unit      â”‚    â”‚ â€¢ Unit      â”‚    â”‚ â€¢ Unit      â”‚
â”‚ â€¢ Tenant    â”‚    â”‚ â€¢ Tenant    â”‚    â”‚ â€¢ Tenant    â”‚
â”‚ â€¢ Payment   â”‚    â”‚ â€¢ Payment   â”‚    â”‚ â€¢ Payment   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## **âœ… Benefits of This Structure:**

1. **Clear Separation** - Each layer has a single responsibility
2. **Easy Testing** - Can mock interfaces for unit testing
3. **Scalable** - Easy to add new features or change implementations
4. **Maintainable** - Changes in one layer don't affect others
5. **Readable** - Flow is obvious from file organization
6. **Go Best Practices** - Follows standard Go project layout

This structure makes the rental management system much easier to understand and maintain! ğŸ âœ¨
